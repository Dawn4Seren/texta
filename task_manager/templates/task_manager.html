{% extends "index.html" %}
{% block app %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}dataset_importer/dataset_importer.css">
<script type="application/javascript" src="{{STATIC_URL}}task_manager/task_manager.js"></script>

<div class="row">
	<div class="col-md-12">
		<ul class="nav nav-pills">
			{% for task_param in task_params %}
				<li class="{% if forloop.counter0 < 1 %}active{% endif %}"><a data-toggle="tab" href="#{{task_param.id}}">{{task_param.name}}</a></li>
			{% endfor %}					
		</ul>
	</div>
</div>

<div class="row">
	<form id="task_params">
		<div class="col-lg-3">
			<div class="tab-content">
					{% for task_param in task_params %}
						<div id="{{task_param.id}}" class="tab-pane fade in {% if forloop.counter0 < 1 %}active{% endif %}">
							{% include task_param.template %}    
						</div>
					{% endfor %}
			</div>
		</div>
	</form>
	
	<div class="col-lg-9">
		<div class="panel">
			<div class="panel-heading">Tasks</div>
			<div class="panel-body">
				<table class="table table-striped">
					<thead>
					  <tr>
						<th>Task ID</th>
						<th>Task Type</th>
						<th>User</th>
						<th>Description</th>
						<th>Task Status</th>
						<th>Task Started</th>
						<th>Task Completed</th>
						<th>Parameters</th>
						<th>Result</th>
						<th>Actions</th>
					</tr>
					</thead>
					{% for task in tasks %}
						<tr>
							<td>{{task.id}}</td>
							<td>{{task.task_type}}</td>
							<td>{{task.user}}</td>
							<td>{{task.description}}</td>
							<td>{{task.status}}</td>
							<td>{{task.time_started|date:"d.m.Y H:i"}}</td>
							<td>{{task.time_completed|date:"d.m.Y H:i"}}</td>							
							<td>
								<table class="table table-striped table-condensed">
									{% for k,v in task.parameters.items %}
										<tr>
											<td><b>{{k}}</b></td>
											<td>{{v}}</td>
										</tr>
									{% endfor %}
								</table>
							</td>
							<td>
								<table class="table table-striped table-condensed">
									{% for k,v in task.result.items %}
										<tr>
											<td><b>{{k}}</b></td>
											<td>{{v}}</td>
										</tr>
									{% endfor %}
								</table>
							</td>
							<td>
								<a href="action('delete', {{task.id}});" title="Delete task result"><span class="glyphicon glyphicon-remove"></span></a>
							</td>
						</tr>
					{% endfor %}
				</table>
			</div>
        </div>
	</div>

</div>

{% endblock %}
