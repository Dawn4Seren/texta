{% extends "index.html" %}
{% block app %}

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>

    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}dataset_importer/dataset_importer.css">

    <div class="col-md-4">
        <div class="panel">
            <div class="panel-heading">
                New Dataset
            </div>

            <div class="panel-body">
                <fieldset>
                    <legend>
                        Data formats
                        <span data-toggle="tooltip" data-placement="bottom" title="Select all the data formats that you want to be processed within your data source" class="glyphicon glyphicon-question-sign texta-tooltip"></span>
                    </legend>
                    <div class="form-group">
                        <select id="data-formats" class="selectpicker form-control" multiple data-selected-text-format="static" title="Select all applicable formats">
                            <optgroup label="Archives">
                                {% for input_type in  enabled_input_types.archive %}
                                    <option value="{{ input_type.value }}" data-parameters-tags="{{ input_type.parameter_tags }}" data-input-category="archive">{{ input_type.name }}</option>
                                {% endfor %}
                            </optgroup>
                            <optgroup label="Simple documents">
                                {% for input_type in  enabled_input_types.single %}
                                    <option value="{{ input_type.value }}" data-parameters-tags="{{ input_type.parameter_tags }}" data-input-category="file">{{ input_type.name }}</option>
                                {% endfor %}
                            </optgroup>
                            <optgroup label="Document collections">
                                {% for input_type in  enabled_input_types.collection %}
                                    <option value="{{ input_type.value }}" data-parameters-tags="{{ input_type.parameter_tags }}" data-input-category="file">{{ input_type.name }}</option>
                                {% endfor %}
                            </optgroup>
                            <optgroup label="Databases">
                                {% for input_type in  enabled_input_types.database %}
                                    <option value="{{ input_type.value }}" data-parameters-tags="{{ input_type.parameter_tags }}" data-input-category="database">{{ input_type.name }}</option>
                                {% endfor %}
                            </optgroup>
                        </select>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>
                        Input data
                        <span data-toggle="tooltip" data-placement="bottom" title="Necessary details and parameters for the selected input data formats" class="glyphicon glyphicon-question-sign texta-tooltip"></span>
                    </legend>

                    <div id="file-format-parameters" class="format-parameters">
                        <div class="btn-group btn-group-justified" role="group">
                          <div class="btn-group" role="group">
                            <button type="button" class="btn btn-default file-input-method-btn" value="upload">File upload</button>
                          </div>
                          <div class="btn-group" role="group">
                            <button type="button" class="btn btn-default file-input-method-btn" value="url">URL</button>
                          </div>
                          <div class="btn-group" role="group">
                            <button type="button" class="btn btn-default file-input-method-btn" value="directory">Server directory</button>
                          </div>
                        </div>

                        <div id="url-file-input" class="file-input-method">
                            <div class="form-group">
                                <input class="form-control" name="url" placeholder="URL to file/archive">
                            </div>
                        </div>

                        <div id="upload-file-input" class="file-input-method">
                            <input type="file" name="file" title="Select file/archive">
                        </div>

                        <div id="directory-file-input" class="file-input-method">
                            <div class="form-group">
                                <input class="form-control" name="directory" placeholder="Local directory path">
                            </div>
                        </div>

                    </div>

                </fieldset>



                {% include "elastic_parameters_panel.html" %}

                <fieldset class="form-group">
                    <legend>
                        Preprocessors
                        <span data-toggle="tooltip" data-placement="bottom" title="Preprocessors are applied - if possible - to each document before they are stored" class="glyphicon glyphicon-question-sign texta-tooltip"></span>
                    </legend>

                    <div class="list-group">
                       {% for preprocessor in enabled_preprocessors %}
                            <div class="list-group-item">
                                <div class="list-group-item-heading">
                                    <div class="checkbox">
                                        <label class="preprocessor-name">
                                            <input type="checkbox" class="apply-preprocessor" value="{{ preprocessor.code }}" data-preprocessor-idx="{{ forloop.counter }}">{{ preprocessor.name }}
                                            <span data-toggle="tooltip" data-placement="bottom" title="{{ preprocessor.description }}" class="glyphicon glyphicon-question-sign texta-tooltip"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="list-group-item-text preprocessor-parameters" id="preprocessor-{{ forloop.counter }}-parameters">
                                    {% include preprocessor.parameters_template %}
                                </div>
                            </div>
                        {%  endfor %}
                    </div>

                </fieldset>

                <button id="import-dataset-btn" class="btn btn-success pull-right">Import</button>

            </div>
        </div>
    </div>

    <div class="col-md-8">
        <div class="panel">
            <div class="panel-heading">
                Import Jobs
            </div>

            <div class="panel-body" id="jobs-table-div">
                {% include "import_jobs_table.html" %}
            </div>
        </div>
    </div>

    <script type="application/javascript" src="{{STATIC_URL}}dataset_importer/argument_collectors.js"></script>
    <script type="application/javascript" src="{{STATIC_URL}}dataset_importer/dataset_importer.js"></script>

{% endblock %}
